<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- | General configuration required to run any CLI function</span><span>
</span><span id="line-2"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Fission.CLI.Config.Base.Types</span><span>
</span><span id="line-3"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Fission.CLI.Config.Base.Types.html#BaseConfig"><span class="hs-identifier">BaseConfig</span></a></span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-4"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Fission.CLI.Config.Base.Types.html#FissionBase"><span class="hs-identifier">FissionBase</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-5"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-6"></span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Crypto.PubKey.Ed25519</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Ed25519</span></span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">RIO.ByteString.Lazy</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Lazy</span></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">RIO.Text</span></span><span>            </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Text</span></span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Char8</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BS8</span></span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Network.DNS</span></span><span>         </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">DNS</span></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Network.HTTP.Client</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HTTP</span></span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Network.IPFS</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Network.IPFS.Types</span></span><span>         </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">IPFS</span></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Network.IPFS.Process.Error</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Process</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Network.IPFS.Process</span></span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Servant.Client</span></span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Fission.Prelude.html"><span class="hs-identifier">Fission.Prelude</span></a></span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Fission.Authorization.ServerDID.html"><span class="hs-identifier">Fission.Authorization.ServerDID</span></a></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Fission.Error.NotFound.Types.html"><span class="hs-identifier">Fission.Error.NotFound.Types</span></a></span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Fission.Key.html"><span class="hs-identifier">Fission.Key</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Key</span></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Fission.User.DID.Types.html"><span class="hs-identifier">Fission.User.DID.Types</span></a></span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Fission.Web.Auth.Token.html"><span class="hs-identifier">Fission.Web.Auth.Token</span></a></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Fission.Web.Auth.Token.Bearer.Types.html"><span class="hs-identifier">Fission.Web.Auth.Token.Bearer.Types</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Bearer</span></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Fission.Web.Auth.Token.JWT.html"><span class="hs-identifier">Fission.Web.Auth.Token.JWT</span></a></span><span>          </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">JWT</span></span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Fission.Web.Client.html"><span class="hs-identifier">Fission.Web.Client</span></a></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Fission.Web.Client.JWT.html"><span class="hs-identifier">Fission.Web.Client.JWT</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">JWT</span></span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Fission.CLI.Display.Error.html"><span class="hs-identifier">Fission.CLI.Display.Error</span></a></span><span>  </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CLI.Error</span></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Fission.CLI.Display.Loader.html"><span class="hs-identifier">Fission.CLI.Display.Loader</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CLI</span></span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-comment">-- | The configuration used for the CLI application</span><span>
</span><span id="line-43"></span><span class="hs-keyword">data</span><span> </span><span id="BaseConfig"><span class="annot"><a href="Fission.CLI.Config.Base.Types.html#BaseConfig"><span class="hs-identifier hs-var">BaseConfig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="BaseConfig"><span class="annot"><a href="Fission.CLI.Config.Base.Types.html#BaseConfig"><span class="hs-identifier hs-var">BaseConfig</span></a></span></span><span>
</span><span id="line-44"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="%24sel%3AhttpManager%3ABaseConfig"><span class="annot"><span class="annottext">BaseConfig -&gt; Manager
</span><a href="Fission.CLI.Config.Base.Types.html#%24sel%3AhttpManager%3ABaseConfig"><span class="hs-identifier hs-var hs-var">httpManager</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">HTTP.Manager</span></span><span>
</span><span id="line-45"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AfissionURL%3ABaseConfig"><span class="annot"><span class="annottext">BaseConfig -&gt; BaseUrl
</span><a href="Fission.CLI.Config.Base.Types.html#%24sel%3AfissionURL%3ABaseConfig"><span class="hs-identifier hs-var hs-var">fissionURL</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">BaseUrl</span></span><span>
</span><span id="line-46"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AcachedServerDID%3ABaseConfig"><span class="annot"><span class="annottext">BaseConfig -&gt; Maybe DID
</span><a href="Fission.CLI.Config.Base.Types.html#%24sel%3AcachedServerDID%3ABaseConfig"><span class="hs-identifier hs-var hs-var">cachedServerDID</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Fission.User.DID.Types.html#DID"><span class="hs-identifier hs-type">DID</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Typically from setting with envar</span><span>
</span><span id="line-47"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AlogFunc%3ABaseConfig"><span class="annot"><span class="annottext">BaseConfig -&gt; LogFunc
</span><a href="Fission.CLI.Config.Base.Types.html#%24sel%3AlogFunc%3ABaseConfig"><span class="hs-identifier hs-var hs-var">logFunc</span></a></span></span><span>         </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">LogFunc</span></span><span>
</span><span id="line-48"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AprocessCtx%3ABaseConfig"><span class="annot"><span class="annottext">BaseConfig -&gt; ProcessContext
</span><a href="Fission.CLI.Config.Base.Types.html#%24sel%3AprocessCtx%3ABaseConfig"><span class="hs-identifier hs-var hs-var">processCtx</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">ProcessContext</span></span><span>
</span><span id="line-49"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AipfsPath%3ABaseConfig"><span class="annot"><span class="annottext">BaseConfig -&gt; BinPath
</span><a href="Fission.CLI.Config.Base.Types.html#%24sel%3AipfsPath%3ABaseConfig"><span class="hs-identifier hs-var hs-var">ipfsPath</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">IPFS.BinPath</span></span><span>
</span><span id="line-50"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AipfsTimeout%3ABaseConfig"><span class="annot"><span class="annottext">BaseConfig -&gt; Timeout
</span><a href="Fission.CLI.Config.Base.Types.html#%24sel%3AipfsTimeout%3ABaseConfig"><span class="hs-identifier hs-var hs-var">ipfsTimeout</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">IPFS.Timeout</span></span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasProcessContext</span></span><span> </span><span class="annot"><a href="Fission.CLI.Config.Base.Types.html#BaseConfig"><span class="hs-identifier hs-type">BaseConfig</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-54"></span><span>  </span><span id="local-6989586621680258206"><span class="annot"><span class="annottext">processContextL :: (ProcessContext -&gt; f ProcessContext) -&gt; BaseConfig -&gt; f BaseConfig
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">processContextL</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(BaseConfig -&gt; ProcessContext)
-&gt; (BaseConfig -&gt; ProcessContext -&gt; BaseConfig)
-&gt; Lens' BaseConfig ProcessContext
forall s a b t. (s -&gt; a) -&gt; (s -&gt; b -&gt; t) -&gt; Lens s t a b
</span><span class="hs-identifier hs-var">lens</span></span><span> </span><span class="annot"><span class="annottext">BaseConfig -&gt; ProcessContext
</span><a href="Fission.CLI.Config.Base.Types.html#%24sel%3AprocessCtx%3ABaseConfig"><span class="hs-identifier hs-var hs-var">processCtx</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680258203"><span class="annot"><span class="annottext">cfg :: BaseConfig
</span><a href="#local-6989586621680258203"><span class="hs-identifier hs-var">cfg</span></a></span></span><span> </span><span id="local-6989586621680258202"><span class="annot"><span class="annottext">newProcessCtx :: ProcessContext
</span><a href="#local-6989586621680258202"><span class="hs-identifier hs-var">newProcessCtx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-55"></span><span>    </span><span class="annot"><span class="annottext">BaseConfig
</span><a href="#local-6989586621680258203"><span class="hs-identifier hs-var">cfg</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:processCtx:BaseConfig :: ProcessContext
</span><a href="Fission.CLI.Config.Base.Types.html#%24sel%3AprocessCtx%3ABaseConfig"><span class="hs-identifier hs-var">processCtx</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProcessContext
</span><a href="#local-6989586621680258202"><span class="hs-identifier hs-var">newProcessCtx</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasLogFunc</span></span><span> </span><span class="annot"><a href="Fission.CLI.Config.Base.Types.html#BaseConfig"><span class="hs-identifier hs-type">BaseConfig</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-58"></span><span>  </span><span id="local-6989586621680258199"><span class="annot"><span class="annottext">logFuncL :: (LogFunc -&gt; f LogFunc) -&gt; BaseConfig -&gt; f BaseConfig
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">logFuncL</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(BaseConfig -&gt; LogFunc)
-&gt; (BaseConfig -&gt; LogFunc -&gt; BaseConfig)
-&gt; Lens' BaseConfig LogFunc
forall s a b t. (s -&gt; a) -&gt; (s -&gt; b -&gt; t) -&gt; Lens s t a b
</span><span class="hs-identifier hs-var">lens</span></span><span> </span><span class="annot"><span class="annottext">BaseConfig -&gt; LogFunc
</span><a href="Fission.CLI.Config.Base.Types.html#%24sel%3AlogFunc%3ABaseConfig"><span class="hs-identifier hs-var hs-var">logFunc</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680258197"><span class="annot"><span class="annottext">cfg :: BaseConfig
</span><a href="#local-6989586621680258197"><span class="hs-identifier hs-var">cfg</span></a></span></span><span> </span><span id="local-6989586621680258196"><span class="annot"><span class="annottext">newLogFunc' :: LogFunc
</span><a href="#local-6989586621680258196"><span class="hs-identifier hs-var">newLogFunc'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-59"></span><span>    </span><span class="annot"><span class="annottext">BaseConfig
</span><a href="#local-6989586621680258197"><span class="hs-identifier hs-var">cfg</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:logFunc:BaseConfig :: LogFunc
</span><a href="Fission.CLI.Config.Base.Types.html#%24sel%3AlogFunc%3ABaseConfig"><span class="hs-identifier hs-var">logFunc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LogFunc
</span><a href="#local-6989586621680258196"><span class="hs-identifier hs-var">newLogFunc'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-comment">-- | The top-level app type</span><span>
</span><span id="line-62"></span><span class="hs-keyword">newtype</span><span> </span><span id="FissionBase"><span class="annot"><a href="Fission.CLI.Config.Base.Types.html#FissionBase"><span class="hs-identifier hs-var">FissionBase</span></a></span></span><span> </span><span id="local-6989586621680258299"><span class="annot"><a href="#local-6989586621680258299"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="FissionBase"><span class="annot"><a href="Fission.CLI.Config.Base.Types.html#FissionBase"><span class="hs-identifier hs-var">FissionBase</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="%24sel%3AunwrapFissionBase%3AFissionBase"><span class="annot"><span class="annottext">FissionBase a -&gt; RIO BaseConfig a
</span><a href="Fission.CLI.Config.Base.Types.html#%24sel%3AunwrapFissionBase%3AFissionBase"><span class="hs-identifier hs-var hs-var">unwrapFissionBase</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RIO</span></span><span> </span><span class="annot"><a href="Fission.CLI.Config.Base.Types.html#BaseConfig"><span class="hs-identifier hs-type">BaseConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680258299"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-63"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">newtype</span></span><span> </span><span class="hs-special">(</span><span> </span><span id="local-6989586621680258190"><span id="local-6989586621680258192"><span class="annot"><span class="annottext">a -&gt; FissionBase b -&gt; FissionBase a
(a -&gt; b) -&gt; FissionBase a -&gt; FissionBase b
(forall a b. (a -&gt; b) -&gt; FissionBase a -&gt; FissionBase b)
-&gt; (forall a b. a -&gt; FissionBase b -&gt; FissionBase a)
-&gt; Functor FissionBase
forall a b. a -&gt; FissionBase b -&gt; FissionBase a
forall a b. (a -&gt; b) -&gt; FissionBase a -&gt; FissionBase b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
&lt;$ :: a -&gt; FissionBase b -&gt; FissionBase a
$c&lt;$ :: forall a b. a -&gt; FissionBase b -&gt; FissionBase a
fmap :: (a -&gt; b) -&gt; FissionBase a -&gt; FissionBase b
$cfmap :: forall a b. (a -&gt; b) -&gt; FissionBase a -&gt; FissionBase b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span>
</span><span id="line-64"></span><span>                   </span><span class="hs-special">,</span><span> </span><span id="local-6989586621680258178"><span id="local-6989586621680258180"><span id="local-6989586621680258182"><span id="local-6989586621680258184"><span id="local-6989586621680258186"><span class="annot"><span class="annottext">Functor FissionBase
a -&gt; FissionBase a
Functor FissionBase =&gt;
(forall a. a -&gt; FissionBase a)
-&gt; (forall a b.
    FissionBase (a -&gt; b) -&gt; FissionBase a -&gt; FissionBase b)
-&gt; (forall a b c.
    (a -&gt; b -&gt; c) -&gt; FissionBase a -&gt; FissionBase b -&gt; FissionBase c)
-&gt; (forall a b. FissionBase a -&gt; FissionBase b -&gt; FissionBase b)
-&gt; (forall a b. FissionBase a -&gt; FissionBase b -&gt; FissionBase a)
-&gt; Applicative FissionBase
FissionBase a -&gt; FissionBase b -&gt; FissionBase b
FissionBase a -&gt; FissionBase b -&gt; FissionBase a
FissionBase (a -&gt; b) -&gt; FissionBase a -&gt; FissionBase b
(a -&gt; b -&gt; c) -&gt; FissionBase a -&gt; FissionBase b -&gt; FissionBase c
forall a. a -&gt; FissionBase a
forall a b. FissionBase a -&gt; FissionBase b -&gt; FissionBase a
forall a b. FissionBase a -&gt; FissionBase b -&gt; FissionBase b
forall a b. FissionBase (a -&gt; b) -&gt; FissionBase a -&gt; FissionBase b
forall a b c.
(a -&gt; b -&gt; c) -&gt; FissionBase a -&gt; FissionBase b -&gt; FissionBase c
forall (f :: * -&gt; *).
Functor f =&gt;
(forall a. a -&gt; f a)
-&gt; (forall a b. f (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c)
-&gt; (forall a b. f a -&gt; f b -&gt; f b)
-&gt; (forall a b. f a -&gt; f b -&gt; f a)
-&gt; Applicative f
&lt;* :: FissionBase a -&gt; FissionBase b -&gt; FissionBase a
$c&lt;* :: forall a b. FissionBase a -&gt; FissionBase b -&gt; FissionBase a
*&gt; :: FissionBase a -&gt; FissionBase b -&gt; FissionBase b
$c*&gt; :: forall a b. FissionBase a -&gt; FissionBase b -&gt; FissionBase b
liftA2 :: (a -&gt; b -&gt; c) -&gt; FissionBase a -&gt; FissionBase b -&gt; FissionBase c
$cliftA2 :: forall a b c.
(a -&gt; b -&gt; c) -&gt; FissionBase a -&gt; FissionBase b -&gt; FissionBase c
&lt;*&gt; :: FissionBase (a -&gt; b) -&gt; FissionBase a -&gt; FissionBase b
$c&lt;*&gt; :: forall a b. FissionBase (a -&gt; b) -&gt; FissionBase a -&gt; FissionBase b
pure :: a -&gt; FissionBase a
$cpure :: forall a. a -&gt; FissionBase a
$cp1Applicative :: Functor FissionBase
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Applicative</span></span></span></span></span></span></span><span>
</span><span id="line-65"></span><span>                   </span><span class="hs-special">,</span><span> </span><span id="local-6989586621680258170"><span id="local-6989586621680258172"><span id="local-6989586621680258174"><span class="annot"><span class="annottext">Applicative FissionBase
a -&gt; FissionBase a
Applicative FissionBase =&gt;
(forall a b.
 FissionBase a -&gt; (a -&gt; FissionBase b) -&gt; FissionBase b)
-&gt; (forall a b. FissionBase a -&gt; FissionBase b -&gt; FissionBase b)
-&gt; (forall a. a -&gt; FissionBase a)
-&gt; Monad FissionBase
FissionBase a -&gt; (a -&gt; FissionBase b) -&gt; FissionBase b
FissionBase a -&gt; FissionBase b -&gt; FissionBase b
forall a. a -&gt; FissionBase a
forall a b. FissionBase a -&gt; FissionBase b -&gt; FissionBase b
forall a b. FissionBase a -&gt; (a -&gt; FissionBase b) -&gt; FissionBase b
forall (m :: * -&gt; *).
Applicative m =&gt;
(forall a b. m a -&gt; (a -&gt; m b) -&gt; m b)
-&gt; (forall a b. m a -&gt; m b -&gt; m b)
-&gt; (forall a. a -&gt; m a)
-&gt; Monad m
return :: a -&gt; FissionBase a
$creturn :: forall a. a -&gt; FissionBase a
&gt;&gt; :: FissionBase a -&gt; FissionBase b -&gt; FissionBase b
$c&gt;&gt; :: forall a b. FissionBase a -&gt; FissionBase b -&gt; FissionBase b
&gt;&gt;= :: FissionBase a -&gt; (a -&gt; FissionBase b) -&gt; FissionBase b
$c&gt;&gt;= :: forall a b. FissionBase a -&gt; (a -&gt; FissionBase b) -&gt; FissionBase b
$cp1Monad :: Applicative FissionBase
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Monad</span></span></span></span></span><span>
</span><span id="line-66"></span><span>                   </span><span class="hs-special">,</span><span> </span><span id="local-6989586621680258166"><span class="annot"><span class="annottext">Monad FissionBase
Monad FissionBase =&gt;
(forall a. IO a -&gt; FissionBase a) -&gt; MonadIO FissionBase
IO a -&gt; FissionBase a
forall a. IO a -&gt; FissionBase a
forall (m :: * -&gt; *).
Monad m =&gt;
(forall a. IO a -&gt; m a) -&gt; MonadIO m
liftIO :: IO a -&gt; FissionBase a
$cliftIO :: forall a. IO a -&gt; FissionBase a
$cp1MonadIO :: Monad FissionBase
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var">MonadIO</span></span></span><span>
</span><span id="line-67"></span><span>                   </span><span class="hs-special">,</span><span> </span><span id="local-6989586621680258160"><span id="local-6989586621680258162"><span class="annot"><span class="annottext">MonadIO FissionBase
FissionBase (UnliftIO FissionBase)
MonadIO FissionBase =&gt;
FissionBase (UnliftIO FissionBase)
-&gt; (forall b.
    ((forall a. FissionBase a -&gt; IO a) -&gt; IO b) -&gt; FissionBase b)
-&gt; MonadUnliftIO FissionBase
((forall a. FissionBase a -&gt; IO a) -&gt; IO b) -&gt; FissionBase b
forall b.
((forall a. FissionBase a -&gt; IO a) -&gt; IO b) -&gt; FissionBase b
forall (m :: * -&gt; *).
MonadIO m =&gt;
m (UnliftIO m)
-&gt; (forall b. ((forall a. m a -&gt; IO a) -&gt; IO b) -&gt; m b)
-&gt; MonadUnliftIO m
withRunInIO :: ((forall a. FissionBase a -&gt; IO a) -&gt; IO b) -&gt; FissionBase b
$cwithRunInIO :: forall b.
((forall a. FissionBase a -&gt; IO a) -&gt; IO b) -&gt; FissionBase b
askUnliftIO :: FissionBase (UnliftIO FissionBase)
$caskUnliftIO :: FissionBase (UnliftIO FissionBase)
$cp1MonadUnliftIO :: MonadIO FissionBase
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var">MonadUnliftIO</span></span></span></span><span>
</span><span id="line-68"></span><span>                   </span><span class="hs-special">,</span><span> </span><span id="local-6989586621680258152"><span id="local-6989586621680258154"><span id="local-6989586621680258156"><span class="annot"><span class="hs-identifier hs-type">MonadReader</span></span><span> </span><span class="annot"><a href="Fission.CLI.Config.Base.Types.html#BaseConfig"><span class="hs-identifier hs-type">BaseConfig</span></a></span></span></span></span><span>
</span><span id="line-69"></span><span>                   </span><span class="hs-special">,</span><span> </span><span id="local-6989586621680258148"><span class="annot"><span class="annottext">Monad FissionBase
e -&gt; FissionBase a
Monad FissionBase =&gt;
(forall e a. Exception e =&gt; e -&gt; FissionBase a)
-&gt; MonadThrow FissionBase
forall e a. Exception e =&gt; e -&gt; FissionBase a
forall (m :: * -&gt; *).
Monad m =&gt;
(forall e a. Exception e =&gt; e -&gt; m a) -&gt; MonadThrow m
throwM :: e -&gt; FissionBase a
$cthrowM :: forall e a. Exception e =&gt; e -&gt; FissionBase a
$cp1MonadThrow :: Monad FissionBase
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var">MonadThrow</span></span></span><span>
</span><span id="line-70"></span><span>                   </span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadLogger</span></span><span> </span><span class="annot"><a href="Fission.CLI.Config.Base.Types.html#FissionBase"><span class="hs-identifier hs-type">FissionBase</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-73"></span><span>  </span><span id="local-6989586621680258143"><span class="annot"><span class="annottext">monadLoggerLog :: Loc -&gt; LogSource -&gt; LogLevel -&gt; msg -&gt; FissionBase ()
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">monadLoggerLog</span></span></span><span> </span><span id="local-6989586621680258141"><span class="annot"><span class="annottext">loc :: Loc
</span><a href="#local-6989586621680258141"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621680258140"><span class="annot"><span class="annottext">src :: LogSource
</span><a href="#local-6989586621680258140"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621680258139"><span class="annot"><span class="annottext">lvl :: LogLevel
</span><a href="#local-6989586621680258139"><span class="hs-identifier hs-var">lvl</span></a></span></span><span> </span><span id="local-6989586621680258138"><span class="annot"><span class="annottext">msg :: msg
</span><a href="#local-6989586621680258138"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RIO BaseConfig () -&gt; FissionBase ()
forall a. RIO BaseConfig a -&gt; FissionBase a
</span><a href="Fission.CLI.Config.Base.Types.html#FissionBase"><span class="hs-identifier hs-var">FissionBase</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Loc -&gt; LogSource -&gt; LogLevel -&gt; msg -&gt; RIO BaseConfig ()
forall (m :: * -&gt; *) msg.
(MonadLogger m, ToLogStr msg) =&gt;
Loc -&gt; LogSource -&gt; LogLevel -&gt; msg -&gt; m ()
</span><span class="hs-identifier hs-var">monadLoggerLog</span></span><span> </span><span class="annot"><span class="annottext">Loc
</span><a href="#local-6989586621680258141"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">LogSource
</span><a href="#local-6989586621680258140"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">LogLevel
</span><a href="#local-6989586621680258139"><span class="hs-identifier hs-var">lvl</span></a></span><span> </span><span class="annot"><span class="annottext">msg
</span><a href="#local-6989586621680258138"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Fission.Web.Client.Class.html#MonadWebClient"><span class="hs-identifier hs-type">MonadWebClient</span></a></span><span> </span><span class="annot"><a href="Fission.CLI.Config.Base.Types.html#FissionBase"><span class="hs-identifier hs-type">FissionBase</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-76"></span><span>  </span><span id="local-6989586621680258134"><span class="annot"><span class="annottext">sendRequest :: ClientM a -&gt; FissionBase (Either ClientError a)
</span><a href="Fission.Web.Client.Class.html#sendRequest"><span class="hs-identifier hs-var hs-var hs-var hs-var">sendRequest</span></a></span></span><span> </span><span id="local-6989586621680258132"><span class="annot"><span class="annottext">req :: ClientM a
</span><a href="#local-6989586621680258132"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-77"></span><span>    </span><span class="annot"><span class="annottext">Natural
-&gt; FissionBase (Either ClientError a)
-&gt; FissionBase (Either ClientError a)
forall (m :: * -&gt; *) a. MonadUnliftIO m =&gt; Natural -&gt; m a -&gt; m a
</span><a href="Fission.CLI.Display.Loader.html#withLoader"><span class="hs-identifier hs-var">CLI.withLoader</span></a></span><span> </span><span class="annot"><span class="hs-number">50_000</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-78"></span><span>      </span><span id="local-6989586621680258130"><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621680258130"><span class="hs-identifier hs-var">manager</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(BaseConfig -&gt; Manager) -&gt; FissionBase Manager
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">BaseConfig -&gt; Manager
</span><a href="Fission.CLI.Config.Base.Types.html#%24sel%3AhttpManager%3ABaseConfig"><span class="hs-identifier hs-var hs-var">httpManager</span></a></span><span>
</span><span id="line-79"></span><span>      </span><span id="local-6989586621680258128"><span class="annot"><span class="annottext">BaseUrl
</span><a href="#local-6989586621680258128"><span class="hs-identifier hs-var">baseUrl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(BaseConfig -&gt; BaseUrl) -&gt; FissionBase BaseUrl
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">BaseConfig -&gt; BaseUrl
</span><a href="Fission.CLI.Config.Base.Types.html#%24sel%3AfissionURL%3ABaseConfig"><span class="hs-identifier hs-var hs-var">fissionURL</span></a></span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span>      </span><span class="annot"><span class="annottext">IO (Either ClientError a) -&gt; FissionBase (Either ClientError a)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Either ClientError a) -&gt; FissionBase (Either ClientError a))
-&gt; (ClientEnv -&gt; IO (Either ClientError a))
-&gt; ClientEnv
-&gt; FissionBase (Either ClientError a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ClientM a -&gt; ClientEnv -&gt; IO (Either ClientError a)
forall a. ClientM a -&gt; ClientEnv -&gt; IO (Either ClientError a)
</span><span class="hs-identifier hs-var">runClientM</span></span><span> </span><span class="annot"><span class="annottext">ClientM a
</span><a href="#local-6989586621680258132"><span class="hs-identifier hs-var">req</span></a></span><span> </span><span class="annot"><span class="annottext">(ClientEnv -&gt; FissionBase (Either ClientError a))
-&gt; ClientEnv -&gt; FissionBase (Either ClientError a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Manager -&gt; BaseUrl -&gt; ClientEnv
</span><span class="hs-identifier hs-var">mkClientEnv</span></span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621680258130"><span class="hs-identifier hs-var">manager</span></a></span><span> </span><span class="annot"><span class="annottext">BaseUrl
</span><a href="#local-6989586621680258128"><span class="hs-identifier hs-var">baseUrl</span></a></span><span>
</span><span id="line-82"></span><span> </span><span>
</span><span id="line-83"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadTime</span></span><span> </span><span class="annot"><a href="Fission.CLI.Config.Base.Types.html#FissionBase"><span class="hs-identifier hs-type">FissionBase</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-84"></span><span>  </span><span id="local-6989586621680258120"><span class="annot"><span class="annottext">currentTime :: FissionBase UTCTime
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">currentTime</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO UTCTime -&gt; FissionBase UTCTime
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">IO UTCTime
forall (m :: * -&gt; *). MonadIO m =&gt; m UTCTime
</span><span class="hs-identifier hs-var">getCurrentTime</span></span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Fission.Authorization.ServerDID.Class.html#ServerDID"><span class="hs-identifier hs-type">ServerDID</span></a></span><span> </span><span class="annot"><a href="Fission.CLI.Config.Base.Types.html#FissionBase"><span class="hs-identifier hs-type">FissionBase</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-87"></span><span>  </span><span id="local-6989586621680258114"><span class="annot"><span class="annottext">getServerDID :: FissionBase DID
</span><a href="Fission.Authorization.ServerDID.Class.html#getServerDID"><span class="hs-identifier hs-var hs-var hs-var hs-var">getServerDID</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-88"></span><span>    </span><span class="annot"><span class="annottext">(BaseConfig -&gt; Maybe DID) -&gt; FissionBase (Maybe DID)
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">BaseConfig -&gt; Maybe DID
</span><a href="Fission.CLI.Config.Base.Types.html#%24sel%3AcachedServerDID%3ABaseConfig"><span class="hs-identifier hs-var hs-var">cachedServerDID</span></a></span><span> </span><span class="annot"><span class="annottext">FissionBase (Maybe DID)
-&gt; (Maybe DID -&gt; FissionBase DID) -&gt; FissionBase DID
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-89"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680258112"><span class="annot"><span class="annottext">did :: DID
</span><a href="#local-6989586621680258112"><span class="hs-identifier hs-var">did</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-90"></span><span>        </span><span class="annot"><span class="annottext">DID -&gt; FissionBase DID
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">DID
</span><a href="#local-6989586621680258112"><span class="hs-identifier hs-var">did</span></a></span><span>
</span><span id="line-91"></span><span>       </span><span>
</span><span id="line-92"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-93"></span><span>        </span><span id="local-6989586621680258111"><span class="annot"><span class="annottext">ResolvSeed
</span><a href="#local-6989586621680258111"><span class="hs-identifier hs-var">rs</span></a></span></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO ResolvSeed -&gt; FissionBase ResolvSeed
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO ResolvSeed -&gt; FissionBase ResolvSeed)
-&gt; IO ResolvSeed -&gt; FissionBase ResolvSeed
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ResolvConf -&gt; IO ResolvSeed
</span><span class="hs-identifier hs-var">DNS.makeResolvSeed</span></span><span> </span><span class="annot"><span class="annottext">ResolvConf
</span><span class="hs-identifier hs-var">DNS.defaultResolvConf</span></span><span>
</span><span id="line-94"></span><span>        </span><span id="local-6989586621680258108"><span class="annot"><span class="annottext">BaseUrl
</span><a href="#local-6989586621680258108"><span class="hs-identifier hs-var">baseURL</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(BaseConfig -&gt; BaseUrl) -&gt; FissionBase BaseUrl
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">BaseConfig -&gt; BaseUrl
</span><a href="Fission.CLI.Config.Base.Types.html#%24sel%3AfissionURL%3ABaseConfig"><span class="hs-identifier hs-var hs-var">fissionURL</span></a></span><span>
</span><span id="line-95"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680258107"><span class="annot"><span class="annottext">url :: ByteString
</span><a href="#local-6989586621680258107"><span class="hs-identifier hs-var hs-var">url</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString
</span><span class="hs-identifier hs-var">BS8.pack</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ByteString) -&gt; String -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;_did.&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">BaseUrl -&gt; String
</span><span class="hs-identifier hs-var hs-var">baseUrlHost</span></span><span> </span><span class="annot"><span class="annottext">BaseUrl
</span><a href="#local-6989586621680258108"><span class="hs-identifier hs-var">baseURL</span></a></span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span>        </span><span class="annot"><span class="annottext">LogSource -&gt; FissionBase ()
forall msg (m :: * -&gt; *).
(ToLogStr msg, MonadLogger m) =&gt;
msg -&gt; m ()
</span><a href="Fission.Internal.Log.html#logDebug"><span class="hs-identifier hs-var">logDebug</span></a></span><span> </span><span class="annot"><span class="annottext">(LogSource -&gt; FissionBase ()) -&gt; LogSource -&gt; FissionBase ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;No cached server DID. Fetching from &quot;</span></span><span> </span><span class="annot"><span class="annottext">LogSource -&gt; LogSource -&gt; LogSource
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; LogSource
</span><span class="hs-identifier hs-var">decodeUtf8Lenient</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621680258107"><span class="hs-identifier hs-var">url</span></a></span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span>        </span><span class="annot"><span class="annottext">IO (Either DNSError [ByteString])
-&gt; FissionBase (Either DNSError [ByteString])
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ResolvSeed
-&gt; (Resolver -&gt; IO (Either DNSError [ByteString]))
-&gt; IO (Either DNSError [ByteString])
forall a. ResolvSeed -&gt; (Resolver -&gt; IO a) -&gt; IO a
</span><span class="hs-identifier hs-var">DNS.withResolver</span></span><span> </span><span class="annot"><span class="annottext">ResolvSeed
</span><a href="#local-6989586621680258111"><span class="hs-identifier hs-var">rs</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680258101"><span class="annot"><span class="annottext">resolver :: Resolver
</span><a href="#local-6989586621680258101"><span class="hs-identifier hs-var">resolver</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Resolver -&gt; ByteString -&gt; IO (Either DNSError [ByteString])
</span><span class="hs-identifier hs-var">DNS.lookupTXT</span></span><span> </span><span class="annot"><span class="annottext">Resolver
</span><a href="#local-6989586621680258101"><span class="hs-identifier hs-var">resolver</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621680258107"><span class="hs-identifier hs-var">url</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FissionBase (Either DNSError [ByteString])
-&gt; (Either DNSError [ByteString] -&gt; FissionBase DID)
-&gt; FissionBase DID
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-100"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621680258099"><span class="annot"><span class="annottext">err :: DNSError
</span><a href="#local-6989586621680258099"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-101"></span><span>            </span><span class="annot"><span class="annottext">DNSError -&gt; LogSource -&gt; FissionBase ()
forall (m :: * -&gt; *) err.
(MonadIO m, MonadLogger m, Show err) =&gt;
err -&gt; LogSource -&gt; m ()
</span><a href="Fission.CLI.Display.Error.html#put"><span class="hs-identifier hs-var">CLI.Error.put</span></a></span><span> </span><span class="annot"><span class="annottext">DNSError
</span><a href="#local-6989586621680258099"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Unable to find Fission's ID online&quot;</span></span><span>
</span><span id="line-102"></span><span>            </span><span class="annot"><span class="annottext">DNSError -&gt; FissionBase DID
forall (m :: * -&gt; *) e a. (MonadThrow m, Exception e) =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwM</span></span><span> </span><span class="annot"><span class="annottext">DNSError
</span><a href="#local-6989586621680258099"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-105"></span><span>            </span><span class="annot"><span class="annottext">NotFound DID -&gt; LogSource -&gt; FissionBase ()
forall (m :: * -&gt; *) err.
(MonadIO m, MonadLogger m, Show err) =&gt;
err -&gt; LogSource -&gt; m ()
</span><a href="Fission.CLI.Display.Error.html#put"><span class="hs-identifier hs-var">CLI.Error.put</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NotFound DID
forall entity. NotFound entity
</span><a href="Fission.Error.NotFound.Types.html#NotFound"><span class="hs-identifier hs-var">NotFound</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Fission.User.DID.Types.html#DID"><span class="hs-identifier hs-type">DID</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(LogSource -&gt; FissionBase ()) -&gt; LogSource -&gt; FissionBase ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-106"></span><span>              </span><span class="annot"><span class="hs-string">&quot;No TXT record at &quot;</span></span><span> </span><span class="annot"><span class="annottext">LogSource -&gt; LogSource -&gt; LogSource
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; LogSource
</span><span class="hs-identifier hs-var">decodeUtf8Lenient</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621680258107"><span class="hs-identifier hs-var">url</span></a></span><span>
</span><span id="line-107"></span><span>             </span><span>
</span><span id="line-108"></span><span>            </span><span class="annot"><span class="annottext">NotFound DID -&gt; FissionBase DID
forall (m :: * -&gt; *) e a. (MonadThrow m, Exception e) =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwM</span></span><span> </span><span class="annot"><span class="annottext">(NotFound DID -&gt; FissionBase DID)
-&gt; NotFound DID -&gt; FissionBase DID
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NotFound DID
forall entity. NotFound entity
</span><a href="Fission.Error.NotFound.Types.html#NotFound"><span class="hs-identifier hs-var">NotFound</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Fission.User.DID.Types.html#DID"><span class="hs-identifier hs-type">DID</span></a></span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680258095"><span class="annot"><span class="annottext">didTxt :: ByteString
</span><a href="#local-6989586621680258095"><span class="hs-identifier hs-var">didTxt</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-111"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Either String DID
forall a. FromJSON a =&gt; ByteString -&gt; Either String a
</span><span class="hs-identifier hs-var">eitherDecodeStrict</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;\&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621680258095"><span class="hs-identifier hs-var">didTxt</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;\&quot;&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-112"></span><span>              </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621680258093"><span class="annot"><span class="annottext">err :: String
</span><a href="#local-6989586621680258093"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-113"></span><span>                </span><span class="annot"><span class="annottext">String -&gt; LogSource -&gt; FissionBase ()
forall (m :: * -&gt; *) err.
(MonadIO m, MonadLogger m, Show err) =&gt;
err -&gt; LogSource -&gt; m ()
</span><a href="Fission.CLI.Display.Error.html#put"><span class="hs-identifier hs-var">CLI.Error.put</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680258093"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Unable to find Fission's ID online&quot;</span></span><span>
</span><span id="line-114"></span><span>                </span><span class="annot"><span class="annottext">NotFound DID -&gt; FissionBase DID
forall (m :: * -&gt; *) e a. (MonadThrow m, Exception e) =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwM</span></span><span> </span><span class="annot"><span class="annottext">(NotFound DID -&gt; FissionBase DID)
-&gt; NotFound DID -&gt; FissionBase DID
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NotFound DID
forall entity. NotFound entity
</span><a href="Fission.Error.NotFound.Types.html#NotFound"><span class="hs-identifier hs-var">NotFound</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Fission.User.DID.Types.html#DID"><span class="hs-identifier hs-type">DID</span></a></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span>              </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621680258092"><span class="annot"><span class="annottext">did :: DID
</span><a href="#local-6989586621680258092"><span class="hs-identifier hs-var">did</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-117"></span><span>                </span><span class="hs-comment">-- FIXME write the value to disk / root dir</span><span>
</span><span id="line-118"></span><span>                </span><span class="annot"><span class="annottext">DID -&gt; FissionBase DID
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">DID
</span><a href="#local-6989586621680258092"><span class="hs-identifier hs-var">did</span></a></span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Fission.Web.Client.Auth.Class.html#MonadWebAuth"><span class="hs-identifier hs-type">MonadWebAuth</span></a></span><span> </span><span class="annot"><a href="Fission.CLI.Config.Base.Types.html#FissionBase"><span class="hs-identifier hs-type">FissionBase</span></a></span><span> </span><span class="annot"><a href="Fission.Web.Auth.Token.Types.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-121"></span><span>  </span><span id="local-6989586621680258088"><span class="annot"><span class="annottext">getAuth :: FissionBase Token
</span><a href="Fission.Web.Client.Auth.Class.html#getAuth"><span class="hs-identifier hs-var hs-var hs-var hs-var">getAuth</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-122"></span><span>    </span><span id="local-6989586621680258086"><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621680258086"><span class="hs-identifier hs-var">now</span></a></span></span><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FissionBase UTCTime
forall (m :: * -&gt; *). MonadTime m =&gt; m UTCTime
</span><span class="hs-identifier hs-var">currentTime</span></span><span>
</span><span id="line-123"></span><span>    </span><span id="local-6989586621680258085"><span class="annot"><span class="annottext">SecretKey
</span><a href="#local-6989586621680258085"><span class="hs-identifier hs-var">sk</span></a></span></span><span>        </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FissionBase SecretKey
forall (m :: * -&gt; *) auth. MonadWebAuth m auth =&gt; m auth
</span><a href="Fission.Web.Client.Auth.Class.html#getAuth"><span class="hs-identifier hs-var">getAuth</span></a></span><span>
</span><span id="line-124"></span><span>    </span><span id="local-6989586621680258084"><span class="annot"><span class="annottext">DID
</span><a href="#local-6989586621680258084"><span class="hs-identifier hs-var">serverDID</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FissionBase DID
forall (m :: * -&gt; *). ServerDID m =&gt; m DID
</span><a href="Fission.Authorization.ServerDID.Class.html#getServerDID"><span class="hs-identifier hs-var">getServerDID</span></a></span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span>    </span><span class="hs-keyword">let</span><span>
</span><span id="line-127"></span><span>      </span><span id="local-6989586621680258083"><span class="annot"><span class="annottext">jwt :: JWT
</span><a href="#local-6989586621680258083"><span class="hs-identifier hs-var hs-var">jwt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-128"></span><span>        </span><span class="annot"><span class="annottext">UTCTime -&gt; DID -&gt; SecretKey -&gt; Proof -&gt; JWT
</span><a href="Fission.Web.Client.JWT.html#ucan"><span class="hs-identifier hs-var">JWT.ucan</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621680258086"><span class="hs-identifier hs-var">now</span></a></span><span> </span><span class="annot"><span class="annottext">DID
</span><a href="#local-6989586621680258084"><span class="hs-identifier hs-var">serverDID</span></a></span><span> </span><span class="annot"><span class="annottext">SecretKey
</span><a href="#local-6989586621680258085"><span class="hs-identifier hs-var">sk</span></a></span><span> </span><span class="annot"><span class="annottext">Proof
</span><a href="Fission.Web.Auth.Token.JWT.html#RootCredential"><span class="hs-identifier hs-var">RootCredential</span></a></span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span>      </span><span id="local-6989586621680258080"><span class="annot"><span class="annottext">rawContent :: RawContent
</span><a href="#local-6989586621680258080"><span class="hs-identifier hs-var hs-var">rawContent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-131"></span><span>        </span><span class="annot"><span class="annottext">JWT
</span><a href="#local-6989586621680258083"><span class="hs-identifier hs-var">jwt</span></a></span><span>
</span><span id="line-132"></span><span>          </span><span class="annot"><span class="annottext">JWT -&gt; (JWT -&gt; ByteString) -&gt; ByteString
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">|&gt;</span></span><span> </span><span class="annot"><span class="annottext">JWT -&gt; ByteString
forall a. ToJSON a =&gt; a -&gt; ByteString
</span><span class="hs-identifier hs-var">encode</span></span><span>
</span><span id="line-133"></span><span>          </span><span class="annot"><span class="annottext">ByteString -&gt; (ByteString -&gt; ByteString) -&gt; ByteString
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">|&gt;</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">Lazy.toStrict</span></span><span>
</span><span id="line-134"></span><span>          </span><span class="annot"><span class="annottext">ByteString -&gt; (ByteString -&gt; LogSource) -&gt; LogSource
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">|&gt;</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; LogSource
</span><span class="hs-identifier hs-var">decodeUtf8Lenient</span></span><span>
</span><span id="line-135"></span><span>          </span><span class="annot"><span class="annottext">LogSource -&gt; (LogSource -&gt; LogSource) -&gt; LogSource
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">|&gt;</span></span><span> </span><span class="annot"><span class="annottext">LogSource -&gt; LogSource -&gt; LogSource
</span><span class="hs-identifier hs-var">Text.dropPrefix</span></span><span> </span><span class="annot"><span class="hs-string">&quot;\&quot;&quot;</span></span><span>
</span><span id="line-136"></span><span>          </span><span class="annot"><span class="annottext">LogSource -&gt; (LogSource -&gt; LogSource) -&gt; LogSource
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">|&gt;</span></span><span> </span><span class="annot"><span class="annottext">LogSource -&gt; LogSource -&gt; LogSource
</span><span class="hs-identifier hs-var">Text.dropSuffix</span></span><span> </span><span class="annot"><span class="hs-string">&quot;\&quot;&quot;</span></span><span>
</span><span id="line-137"></span><span>          </span><span class="annot"><span class="annottext">LogSource -&gt; (LogSource -&gt; RawContent) -&gt; RawContent
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">|&gt;</span></span><span> </span><span class="annot"><span class="annottext">LogSource -&gt; RawContent
</span><a href="Fission.Web.Auth.Token.JWT.RawContent.html#contentOf"><span class="hs-identifier hs-var">JWT.contentOf</span></a></span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span>    </span><span class="annot"><span class="annottext">Token -&gt; FissionBase Token
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Token -&gt; FissionBase Token) -&gt; Token -&gt; FissionBase Token
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Token -&gt; Token
</span><a href="Fission.Web.Auth.Token.Types.html#Bearer"><span class="hs-identifier hs-var">Bearer</span></a></span><span> </span><span class="annot"><span class="annottext">$WToken :: JWT -&gt; RawContent -&gt; Token
</span><a href="Fission.Web.Auth.Token.Bearer.Types.html#%24WToken"><span class="hs-identifier hs-type hs-type">Bearer.Token</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Fission.Web.Client.Auth.Class.html#MonadWebAuth"><span class="hs-identifier hs-type">MonadWebAuth</span></a></span><span> </span><span class="annot"><a href="Fission.CLI.Config.Base.Types.html#FissionBase"><span class="hs-identifier hs-type">FissionBase</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ed25519.SecretKey</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-142"></span><span>  </span><span id="local-6989586621680258066"><span class="annot"><span class="annottext">getAuth :: FissionBase SecretKey
</span><a href="#local-6989586621680258066"><span class="hs-identifier hs-var hs-var hs-var hs-var">getAuth</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-143"></span><span>    </span><span class="annot"><span class="annottext">FissionBase (Either Error ())
forall (m :: * -&gt; *). MonadIO m =&gt; m (Either Error ())
</span><a href="Fission.Key.Store.html#create"><span class="hs-identifier hs-var">Key.create</span></a></span><span> </span><span class="annot"><span class="annottext">FissionBase (Either Error ())
-&gt; (Either Error () -&gt; FissionBase SecretKey)
-&gt; FissionBase SecretKey
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="annot"><a href="Fission.Key.Error.html#AlreadyExists"><span class="hs-identifier hs-type">Key.AlreadyExists</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-146"></span><span>        </span><span class="annot"><span class="annottext">FissionBase (Either Error SecretKey)
forall (m :: * -&gt; *). MonadIO m =&gt; m (Either Error SecretKey)
</span><a href="Fission.Key.Store.html#readEd"><span class="hs-identifier hs-var">Key.readEd</span></a></span><span> </span><span class="annot"><span class="annottext">FissionBase (Either Error SecretKey)
-&gt; (Either Error SecretKey -&gt; FissionBase SecretKey)
-&gt; FissionBase SecretKey
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-147"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621680258062"><span class="annot"><span class="annottext">err :: Error
</span><a href="#local-6989586621680258062"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-148"></span><span>            </span><span class="annot"><span class="annottext">Error -&gt; LogSource -&gt; FissionBase ()
forall (m :: * -&gt; *) err.
(MonadIO m, MonadLogger m, Show err) =&gt;
err -&gt; LogSource -&gt; m ()
</span><a href="Fission.CLI.Display.Error.html#put"><span class="hs-identifier hs-var">CLI.Error.put</span></a></span><span> </span><span class="annot"><span class="annottext">Error
</span><a href="#local-6989586621680258062"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Unable to find or create key&quot;</span></span><span>
</span><span id="line-149"></span><span>            </span><span class="annot"><span class="annottext">NotFound SecretKey -&gt; FissionBase SecretKey
forall (m :: * -&gt; *) e a. (MonadThrow m, Exception e) =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwM</span></span><span> </span><span class="annot"><span class="annottext">(NotFound SecretKey -&gt; FissionBase SecretKey)
-&gt; NotFound SecretKey -&gt; FissionBase SecretKey
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NotFound SecretKey
forall entity. NotFound entity
</span><a href="Fission.Error.NotFound.Types.html#NotFound"><span class="hs-identifier hs-var">NotFound</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Ed25519.SecretKey</span></span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621680258061"><span class="annot"><span class="annottext">key :: SecretKey
</span><a href="#local-6989586621680258061"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-152"></span><span>            </span><span class="annot"><span class="annottext">SecretKey -&gt; FissionBase SecretKey
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">SecretKey
</span><a href="#local-6989586621680258061"><span class="hs-identifier hs-var">key</span></a></span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621680258060"><span class="annot"><span class="annottext">err :: Error
</span><a href="#local-6989586621680258060"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-155"></span><span>        </span><span class="annot"><span class="annottext">Error -&gt; LogSource -&gt; FissionBase ()
forall (m :: * -&gt; *) err.
(MonadIO m, MonadLogger m, Show err) =&gt;
err -&gt; LogSource -&gt; m ()
</span><a href="Fission.CLI.Display.Error.html#put"><span class="hs-identifier hs-var">CLI.Error.put</span></a></span><span> </span><span class="annot"><span class="annottext">Error
</span><a href="#local-6989586621680258060"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Unable to create key&quot;</span></span><span>
</span><span id="line-156"></span><span>        </span><span class="annot"><span class="annottext">NotFound SecretKey -&gt; FissionBase SecretKey
forall (m :: * -&gt; *) e a. (MonadThrow m, Exception e) =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwM</span></span><span> </span><span class="annot"><span class="annottext">(NotFound SecretKey -&gt; FissionBase SecretKey)
-&gt; NotFound SecretKey -&gt; FissionBase SecretKey
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NotFound SecretKey
forall entity. NotFound entity
</span><a href="Fission.Error.NotFound.Types.html#NotFound"><span class="hs-identifier hs-var">NotFound</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Ed25519.SecretKey</span></span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-159"></span><span>        </span><span class="annot"><span class="annottext">FissionBase SecretKey
forall (m :: * -&gt; *) auth. MonadWebAuth m auth =&gt; m auth
</span><a href="Fission.Web.Client.Auth.Class.html#getAuth"><span class="hs-identifier hs-var">getAuth</span></a></span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadLocalIPFS</span></span><span> </span><span class="annot"><a href="Fission.CLI.Config.Base.Types.html#FissionBase"><span class="hs-identifier hs-type">FissionBase</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-162"></span><span>  </span><span id="local-6989586621680258056"><span class="annot"><span class="annottext">runLocal :: [String] -&gt; ByteString -&gt; FissionBase (Either Error ByteString)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">runLocal</span></span></span><span> </span><span id="local-6989586621680258054"><span class="annot"><span class="annottext">opts :: [String]
</span><a href="#local-6989586621680258054"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span id="local-6989586621680258053"><span class="annot"><span class="annottext">arg :: ByteString
</span><a href="#local-6989586621680258053"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-163"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">IPFS.BinPath</span></span><span> </span><span id="local-6989586621680258051"><span class="annot"><span class="annottext">ipfs :: String
</span><a href="#local-6989586621680258051"><span class="hs-identifier hs-var">ipfs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(BaseConfig -&gt; BinPath) -&gt; FissionBase BinPath
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">BaseConfig -&gt; BinPath
</span><a href="Fission.CLI.Config.Base.Types.html#%24sel%3AipfsPath%3ABaseConfig"><span class="hs-identifier hs-var hs-var">ipfsPath</span></a></span><span>
</span><span id="line-164"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">IPFS.Timeout</span></span><span> </span><span id="local-6989586621680258049"><span class="annot"><span class="annottext">secs :: Natural
</span><a href="#local-6989586621680258049"><span class="hs-identifier hs-var">secs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(BaseConfig -&gt; Timeout) -&gt; FissionBase Timeout
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">BaseConfig -&gt; Timeout
</span><a href="Fission.CLI.Config.Base.Types.html#%24sel%3AipfsTimeout%3ABaseConfig"><span class="hs-identifier hs-var hs-var">ipfsTimeout</span></a></span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680258048"><span class="annot"><span class="annottext">opts' :: [String]
</span><a href="#local-6989586621680258048"><span class="hs-identifier hs-var hs-var">opts'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;--timeout=&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621680258049"><span class="hs-identifier hs-var">secs</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;s&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; [String]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621680258054"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span>    </span><span class="annot"><span class="annottext">(ProcessConfig () (STM ByteString) ()
 -&gt; FissionBase (ExitCode, ByteString, ByteString))
-&gt; String
-&gt; StreamIn ()
-&gt; StreamOut (STM ByteString)
-&gt; [String]
-&gt; FissionBase (ExitCode, ByteString, ByteString)
forall (m :: * -&gt; *) cfg stdin stdout a.
(MonadIO m, MonadReader cfg m, HasProcessContext cfg,
 HasLogFunc cfg) =&gt;
(ProcessConfig stdin stdout () -&gt; m a)
-&gt; String -&gt; StreamIn stdin -&gt; StreamOut stdout -&gt; [String] -&gt; m a
</span><span class="hs-identifier hs-var">runProc</span></span><span> </span><span class="annot"><span class="annottext">ProcessConfig () (STM ByteString) ()
-&gt; FissionBase (ExitCode, ByteString, ByteString)
forall (m :: * -&gt; *) stdin stdoutIgnored stderrIgnored.
MonadIO m =&gt;
ProcessConfig stdin stdoutIgnored stderrIgnored
-&gt; m (ExitCode, ByteString, ByteString)
</span><span class="hs-identifier hs-var">readProcess</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680258051"><span class="hs-identifier hs-var">ipfs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; StreamIn ()
</span><span class="hs-identifier hs-var">byteStringInput</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621680258053"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StreamOut (STM ByteString)
</span><span class="hs-identifier hs-var">byteStringOutput</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621680258048"><span class="hs-identifier hs-var">opts'</span></a></span><span> </span><span class="annot"><span class="annottext">FissionBase (ExitCode, ByteString, ByteString)
-&gt; ((ExitCode, ByteString, ByteString) -&gt; Either Error ByteString)
-&gt; FissionBase (Either Error ByteString)
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-169"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ExitSuccess</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680258040"><span class="annot"><span class="annottext">contents :: ByteString
</span><a href="#local-6989586621680258040"><span class="hs-identifier hs-var">contents</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-170"></span><span>        </span><span class="annot"><span class="annottext">ByteString -&gt; Either Error ByteString
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621680258040"><span class="hs-identifier hs-var">contents</span></a></span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ExitFailure</span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span id="local-6989586621680258038"><span class="annot"><span class="annottext">stdErr :: ByteString
</span><a href="#local-6989586621680258038"><span class="hs-identifier hs-var">stdErr</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Bool
</span><span class="hs-identifier hs-var">Lazy.isSuffixOf</span></span><span> </span><span class="annot"><span class="hs-string">&quot;context deadline exceeded&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621680258038"><span class="hs-identifier hs-var">stdErr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-174"></span><span>            </span><span class="annot"><span class="annottext">Error -&gt; Either Error ByteString
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(Error -&gt; Either Error ByteString)
-&gt; Error -&gt; Either Error ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Error
</span><span class="hs-identifier hs-var">Process.Timeout</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621680258049"><span class="hs-identifier hs-var">secs</span></a></span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-177"></span><span>            </span><span class="annot"><span class="annottext">Error -&gt; Either Error ByteString
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(Error -&gt; Either Error ByteString)
-&gt; Error -&gt; Either Error ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Error
</span><span class="hs-identifier hs-var">Process.UnknownErr</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621680258038"><span class="hs-identifier hs-var">stdErr</span></a></span><span>
</span><span id="line-178"></span></pre></body></html>