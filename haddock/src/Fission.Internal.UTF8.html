<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- | UTF8 text helpers</span><span>
</span><span id="line-2"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Fission.Internal.UTF8</span><span>
</span><span id="line-3"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Fission.Internal.UTF8.html#Textable"><span class="hs-identifier">Textable</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-4"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Fission.Internal.UTF8.html#putText"><span class="hs-identifier">putText</span></a></span><span>
</span><span id="line-5"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Fission.Internal.UTF8.html#putTextLn"><span class="hs-identifier">putTextLn</span></a></span><span>
</span><span id="line-6"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Fission.Internal.UTF8.html#displayLazyBS"><span class="hs-identifier">displayLazyBS</span></a></span><span>
</span><span id="line-7"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Fission.Internal.UTF8.html#toBase58Text"><span class="hs-identifier">toBase58Text</span></a></span><span>
</span><span id="line-8"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Fission.Internal.UTF8.html#fromRawBytes"><span class="hs-identifier">fromRawBytes</span></a></span><span>
</span><span id="line-9"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Fission.Internal.UTF8.html#stripOptionalPrefix"><span class="hs-identifier">stripOptionalPrefix</span></a></span><span>
</span><span id="line-10"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Fission.Internal.UTF8.html#stripOptionalPrefixBS"><span class="hs-identifier">stripOptionalPrefixBS</span></a></span><span>
</span><span id="line-11"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Fission.Internal.UTF8.html#stripOptionalPrefixLazyBS"><span class="hs-identifier">stripOptionalPrefixLazyBS</span></a></span><span>
</span><span id="line-12"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Fission.Internal.UTF8.html#stripOptionalSuffix"><span class="hs-identifier">stripOptionalSuffix</span></a></span><span>
</span><span id="line-13"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Fission.Internal.UTF8.html#stripOptionalSuffixBS"><span class="hs-identifier">stripOptionalSuffixBS</span></a></span><span>
</span><span id="line-14"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Fission.Internal.UTF8.html#stripOptionalSuffixLazyBS"><span class="hs-identifier">stripOptionalSuffixLazyBS</span></a></span><span>
</span><span id="line-15"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Fission.Internal.UTF8.html#stripPadding"><span class="hs-identifier">stripPadding</span></a></span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Fission.Internal.UTF8.html#stripQuotes"><span class="hs-identifier">stripQuotes</span></a></span><span>
</span><span id="line-17"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Fission.Internal.UTF8.html#stripQuotesBS"><span class="hs-identifier">stripQuotesBS</span></a></span><span>
</span><span id="line-18"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Fission.Internal.UTF8.html#stripQuotesLazyBS"><span class="hs-identifier">stripQuotesLazyBS</span></a></span><span>
</span><span id="line-19"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Fission.Internal.UTF8.html#stripN"><span class="hs-identifier">stripN</span></a></span><span>
</span><span id="line-20"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Fission.Internal.UTF8.html#stripNBS"><span class="hs-identifier">stripNBS</span></a></span><span>
</span><span id="line-21"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Fission.Internal.UTF8.html#stripNewline"><span class="hs-identifier">stripNewline</span></a></span><span>
</span><span id="line-22"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Fission.Internal.UTF8.html#textShow"><span class="hs-identifier">textShow</span></a></span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Fission.Internal.UTF8.html#wrapIn"><span class="hs-identifier">wrapIn</span></a></span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Fission.Internal.UTF8.html#wrapInBS"><span class="hs-identifier">wrapInBS</span></a></span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Binary</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">encode</span></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Base58String.Bitcoin</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BS58.BTC</span></span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Flow</span></span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">RIO</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">RIO.ByteString</span></span><span>      </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Strict</span></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">RIO.ByteString.Lazy</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Lazy</span></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">RIO.Text</span></span><span>            </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Text</span></span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span class="hs-comment">-- $setup</span><span>
</span><span id="line-38"></span><span class="hs-comment">-- &gt;&gt;&gt; :set -XOverloadedStrings</span><span>
</span><span id="line-39"></span><span class="hs-comment">-- &gt;&gt;&gt; import Test.QuickCheck</span><span>
</span><span id="line-40"></span><span class="hs-comment">-- &gt;&gt;&gt; import Test.QuickCheck.Instances ()</span><span>
</span><span id="line-41"></span><span class="hs-comment">-- &gt;&gt;&gt; import qualified Data.Text as Text</span><span>
</span><span id="line-42"></span><span class="hs-comment">-- &gt;&gt;&gt; import qualified RIO.ByteString      as Strict</span><span>
</span><span id="line-43"></span><span class="hs-comment">-- &gt;&gt;&gt; import qualified RIO.ByteString.Lazy as Lazy</span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="hs-keyword">class</span><span> </span><span id="Textable"><span class="annot"><a href="Fission.Internal.UTF8.html#Textable"><span class="hs-identifier hs-var">Textable</span></a></span></span><span> </span><span id="local-6989586621680186955"><span class="annot"><a href="#local-6989586621680186955"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-46"></span><span>  </span><span id="encode"><span class="annot"><a href="Fission.Internal.UTF8.html#encode"><span class="hs-identifier hs-type">encode</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680186955"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">UnicodeException</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Fission.Internal.UTF8.html#Textable"><span class="hs-identifier hs-type">Textable</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-49"></span><span>  </span><span id="local-6989586621680186898"><span class="annot"><span class="annottext">encode :: ByteString -&gt; Either UnicodeException Text
</span><a href="#local-6989586621680186898"><span class="hs-identifier hs-var hs-var hs-var hs-var">encode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Either UnicodeException Text
</span><span class="hs-identifier hs-var">decodeUtf8'</span></span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Fission.Internal.UTF8.html#Textable"><span class="hs-identifier hs-type">Textable</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lazy.ByteString</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-52"></span><span>  </span><span id="local-6989586621680186895"><span class="annot"><span class="annottext">encode :: ByteString -&gt; Either UnicodeException Text
</span><a href="#local-6989586621680186895"><span class="hs-identifier hs-var hs-var hs-var hs-var">encode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Either UnicodeException Text
forall a. Textable a =&gt; a -&gt; Either UnicodeException Text
</span><a href="Fission.Internal.UTF8.html#encode"><span class="hs-identifier hs-var">encode</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Either UnicodeException Text)
-&gt; (ByteString -&gt; ByteString)
-&gt; ByteString
-&gt; Either UnicodeException Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">Lazy.toStrict</span></span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span id="local-6989586621680186892"><span class="annot"><a href="Fission.Internal.UTF8.html#displayLazyBS"><span class="hs-identifier hs-type">displayLazyBS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Display</span></span><span> </span><span class="annot"><a href="#local-6989586621680186892"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680186892"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lazy.ByteString</span></span></span><span>
</span><span id="line-55"></span><span id="displayLazyBS"><span class="annot"><span class="annottext">displayLazyBS :: a -&gt; ByteString
</span><a href="Fission.Internal.UTF8.html#displayLazyBS"><span class="hs-identifier hs-var hs-var">displayLazyBS</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">Lazy.fromStrict</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; (a -&gt; ByteString) -&gt; a -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><span class="hs-identifier hs-var">encodeUtf8</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; ByteString) -&gt; (a -&gt; Text) -&gt; a -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Text
forall a. Display a =&gt; a -&gt; Text
</span><span class="hs-identifier hs-var">textDisplay</span></span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="annot"><a href="Fission.Internal.UTF8.html#fromRawBytes"><span class="hs-identifier hs-type">fromRawBytes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-58"></span><span id="fromRawBytes"><span class="annot"><span class="annottext">fromRawBytes :: [Word8] -&gt; Text
</span><a href="Fission.Internal.UTF8.html#fromRawBytes"><span class="hs-identifier hs-var hs-var">fromRawBytes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><span class="hs-identifier hs-var">decodeUtf8Lenient</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Text) -&gt; ([Word8] -&gt; ByteString) -&gt; [Word8] -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Word8] -&gt; ByteString
</span><span class="hs-identifier hs-var">Strict.pack</span></span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="hs-comment">-- | Convert any binary object to 'Text'</span><span>
</span><span id="line-61"></span><span class="hs-comment">--</span><span>
</span><span id="line-62"></span><span class="hs-comment">-- &gt;&gt;&gt; toBase58Text &quot;hello world&quot;</span><span>
</span><span id="line-63"></span><span class="hs-comment">-- &quot;StV1DL6CwTryKyV&quot;</span><span>
</span><span id="line-64"></span><span class="hs-comment">--</span><span>
</span><span id="line-65"></span><span class="hs-comment">-- &gt;&gt;&gt; toBase58Text $ Strict.pack ([0x0ed, 0x01] :: [Word8] )</span><span>
</span><span id="line-66"></span><span class="hs-comment">-- &quot;K36&quot;</span><span>
</span><span id="line-67"></span><span class="hs-comment">--</span><span>
</span><span id="line-68"></span><span class="hs-comment">-- &gt;&gt;&gt; toBase58Text $ Strict.pack ([0xed, 0x01, 0x01, 0x23, 0x45, 0x67] :: [Word8])</span><span>
</span><span id="line-69"></span><span class="hs-comment">-- &quot;332DkaEge&quot;</span><span>
</span><span id="line-70"></span><span class="hs-comment">--</span><span>
</span><span id="line-71"></span><span class="hs-comment">-- NOTE that base58 text does not concatenate without decoding to some base2 first</span><span>
</span><span id="line-72"></span><span class="hs-comment">--</span><span>
</span><span id="line-73"></span><span class="hs-comment">-- &gt;&gt;&gt; toBase58Text &quot;hello world&quot; == toBase58Text &quot;hello &quot; &lt;&gt; toBase58Text &quot;world&quot;</span><span>
</span><span id="line-74"></span><span class="hs-comment">-- False</span><span>
</span><span id="line-75"></span><span class="annot"><a href="Fission.Internal.UTF8.html#toBase58Text"><span class="hs-identifier hs-type">toBase58Text</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Strict.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-76"></span><span id="toBase58Text"><span class="annot"><span class="annottext">toBase58Text :: ByteString -&gt; Text
</span><a href="Fission.Internal.UTF8.html#toBase58Text"><span class="hs-identifier hs-var hs-var">toBase58Text</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Base58String -&gt; Text
</span><span class="hs-identifier hs-var">BS58.BTC.toText</span></span><span> </span><span class="annot"><span class="annottext">(Base58String -&gt; Text)
-&gt; (ByteString -&gt; Base58String) -&gt; ByteString -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Base58String
</span><span class="hs-identifier hs-var">BS58.BTC.fromBytes</span></span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="annot"><a href="Fission.Internal.UTF8.html#stripOptionalPrefix"><span class="hs-identifier hs-type">stripOptionalPrefix</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-79"></span><span id="stripOptionalPrefix"><span class="annot"><span class="annottext">stripOptionalPrefix :: Text -&gt; Text -&gt; Text
</span><a href="Fission.Internal.UTF8.html#stripOptionalPrefix"><span class="hs-identifier hs-var hs-var">stripOptionalPrefix</span></a></span></span><span> </span><span id="local-6989586621680186884"><span class="annot"><span class="annottext">pfx :: Text
</span><a href="#local-6989586621680186884"><span class="hs-identifier hs-var">pfx</span></a></span></span><span> </span><span id="local-6989586621680186883"><span class="annot"><span class="annottext">txt :: Text
</span><a href="#local-6989586621680186883"><span class="hs-identifier hs-var">txt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; (Text -&gt; Text) -&gt; Maybe Text -&gt; Text
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680186883"><span class="hs-identifier hs-var">txt</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Text -&gt; Text) -&gt; Maybe Text -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Maybe Text
</span><span class="hs-identifier hs-var">Text.stripPrefix</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680186884"><span class="hs-identifier hs-var">pfx</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680186883"><span class="hs-identifier hs-var">txt</span></a></span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="annot"><a href="Fission.Internal.UTF8.html#stripOptionalSuffix"><span class="hs-identifier hs-type">stripOptionalSuffix</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-82"></span><span id="stripOptionalSuffix"><span class="annot"><span class="annottext">stripOptionalSuffix :: Text -&gt; Text -&gt; Text
</span><a href="Fission.Internal.UTF8.html#stripOptionalSuffix"><span class="hs-identifier hs-var hs-var">stripOptionalSuffix</span></a></span></span><span> </span><span id="local-6989586621680186879"><span class="annot"><span class="annottext">sfx :: Text
</span><a href="#local-6989586621680186879"><span class="hs-identifier hs-var">sfx</span></a></span></span><span> </span><span id="local-6989586621680186878"><span class="annot"><span class="annottext">txt :: Text
</span><a href="#local-6989586621680186878"><span class="hs-identifier hs-var">txt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; (Text -&gt; Text) -&gt; Maybe Text -&gt; Text
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680186878"><span class="hs-identifier hs-var">txt</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Text -&gt; Text) -&gt; Maybe Text -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Maybe Text
</span><span class="hs-identifier hs-var">Text.stripSuffix</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680186879"><span class="hs-identifier hs-var">sfx</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680186878"><span class="hs-identifier hs-var">txt</span></a></span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="annot"><a href="Fission.Internal.UTF8.html#stripOptionalPrefixBS"><span class="hs-identifier hs-type">stripOptionalPrefixBS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Strict.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Strict.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Strict.ByteString</span></span><span>
</span><span id="line-85"></span><span id="stripOptionalPrefixBS"><span class="annot"><span class="annottext">stripOptionalPrefixBS :: ByteString -&gt; ByteString -&gt; ByteString
</span><a href="Fission.Internal.UTF8.html#stripOptionalPrefixBS"><span class="hs-identifier hs-var hs-var">stripOptionalPrefixBS</span></a></span></span><span> </span><span id="local-6989586621680186876"><span class="annot"><span class="annottext">pfx :: ByteString
</span><a href="#local-6989586621680186876"><span class="hs-identifier hs-var">pfx</span></a></span></span><span> </span><span id="local-6989586621680186875"><span class="annot"><span class="annottext">bs :: ByteString
</span><a href="#local-6989586621680186875"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
-&gt; (ByteString -&gt; ByteString) -&gt; Maybe ByteString -&gt; ByteString
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621680186875"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">(Maybe ByteString -&gt; ByteString) -&gt; Maybe ByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Maybe ByteString
</span><span class="hs-identifier hs-var">Strict.stripPrefix</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621680186876"><span class="hs-identifier hs-var">pfx</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621680186875"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-86"></span><span> </span><span>
</span><span id="line-87"></span><span class="annot"><a href="Fission.Internal.UTF8.html#stripOptionalSuffixBS"><span class="hs-identifier hs-type">stripOptionalSuffixBS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Strict.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Strict.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Strict.ByteString</span></span><span>
</span><span id="line-88"></span><span id="stripOptionalSuffixBS"><span class="annot"><span class="annottext">stripOptionalSuffixBS :: ByteString -&gt; ByteString -&gt; ByteString
</span><a href="Fission.Internal.UTF8.html#stripOptionalSuffixBS"><span class="hs-identifier hs-var hs-var">stripOptionalSuffixBS</span></a></span></span><span> </span><span id="local-6989586621680186873"><span class="annot"><span class="annottext">sfx :: ByteString
</span><a href="#local-6989586621680186873"><span class="hs-identifier hs-var">sfx</span></a></span></span><span> </span><span id="local-6989586621680186872"><span class="annot"><span class="annottext">bs :: ByteString
</span><a href="#local-6989586621680186872"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
-&gt; (ByteString -&gt; ByteString) -&gt; Maybe ByteString -&gt; ByteString
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621680186872"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">(Maybe ByteString -&gt; ByteString) -&gt; Maybe ByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Maybe ByteString
</span><span class="hs-identifier hs-var">Strict.stripSuffix</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621680186873"><span class="hs-identifier hs-var">sfx</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621680186872"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span class="annot"><a href="Fission.Internal.UTF8.html#stripOptionalPrefixLazyBS"><span class="hs-identifier hs-type">stripOptionalPrefixLazyBS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lazy.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lazy.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lazy.ByteString</span></span><span>
</span><span id="line-91"></span><span id="stripOptionalPrefixLazyBS"><span class="annot"><span class="annottext">stripOptionalPrefixLazyBS :: ByteString -&gt; ByteString -&gt; ByteString
</span><a href="Fission.Internal.UTF8.html#stripOptionalPrefixLazyBS"><span class="hs-identifier hs-var hs-var">stripOptionalPrefixLazyBS</span></a></span></span><span> </span><span id="local-6989586621680186870"><span class="annot"><span class="annottext">pfx :: ByteString
</span><a href="#local-6989586621680186870"><span class="hs-identifier hs-var">pfx</span></a></span></span><span> </span><span id="local-6989586621680186869"><span class="annot"><span class="annottext">bs :: ByteString
</span><a href="#local-6989586621680186869"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
-&gt; (ByteString -&gt; ByteString) -&gt; Maybe ByteString -&gt; ByteString
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621680186869"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">(Maybe ByteString -&gt; ByteString) -&gt; Maybe ByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Maybe ByteString
</span><span class="hs-identifier hs-var">Lazy.stripPrefix</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621680186870"><span class="hs-identifier hs-var">pfx</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621680186869"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span class="annot"><a href="Fission.Internal.UTF8.html#stripOptionalSuffixLazyBS"><span class="hs-identifier hs-type">stripOptionalSuffixLazyBS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lazy.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lazy.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lazy.ByteString</span></span><span>
</span><span id="line-94"></span><span id="stripOptionalSuffixLazyBS"><span class="annot"><span class="annottext">stripOptionalSuffixLazyBS :: ByteString -&gt; ByteString -&gt; ByteString
</span><a href="Fission.Internal.UTF8.html#stripOptionalSuffixLazyBS"><span class="hs-identifier hs-var hs-var">stripOptionalSuffixLazyBS</span></a></span></span><span> </span><span id="local-6989586621680186867"><span class="annot"><span class="annottext">sfx :: ByteString
</span><a href="#local-6989586621680186867"><span class="hs-identifier hs-var">sfx</span></a></span></span><span> </span><span id="local-6989586621680186866"><span class="annot"><span class="annottext">bs :: ByteString
</span><a href="#local-6989586621680186866"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
-&gt; (ByteString -&gt; ByteString) -&gt; Maybe ByteString -&gt; ByteString
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621680186866"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">(Maybe ByteString -&gt; ByteString) -&gt; Maybe ByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Maybe ByteString
</span><span class="hs-identifier hs-var">Lazy.stripSuffix</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621680186867"><span class="hs-identifier hs-var">sfx</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621680186866"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="annot"><a href="Fission.Internal.UTF8.html#stripPadding"><span class="hs-identifier hs-type">stripPadding</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-97"></span><span id="stripPadding"><span class="annot"><span class="annottext">stripPadding :: ByteString -&gt; ByteString
</span><a href="Fission.Internal.UTF8.html#stripPadding"><span class="hs-identifier hs-var hs-var">stripPadding</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span>
</span><span id="line-98"></span><span>    </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
</span><a href="Fission.Internal.UTF8.html#stripOptionalSuffixBS"><span class="hs-identifier hs-var">stripOptionalSuffixBS</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;=&quot;</span></span><span> </span><span class="hs-comment">-- per RFC7515</span><span>
</span><span id="line-99"></span><span>  </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString)
-&gt; (ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
</span><a href="Fission.Internal.UTF8.html#stripOptionalSuffixBS"><span class="hs-identifier hs-var">stripOptionalSuffixBS</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;=&quot;</span></span><span> </span><span class="hs-comment">-- incase they trail</span><span>
</span><span id="line-100"></span><span>  </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString)
-&gt; (ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
</span><a href="Fission.Internal.UTF8.html#stripOptionalSuffixBS"><span class="hs-identifier hs-var">stripOptionalSuffixBS</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;=&quot;</span></span><span> </span><span class="hs-comment">-- incase they trail</span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span class="annot"><a href="Fission.Internal.UTF8.html#stripQuotes"><span class="hs-identifier hs-type">stripQuotes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-103"></span><span id="stripQuotes"><span class="annot"><span class="annottext">stripQuotes :: Text -&gt; Text
</span><a href="Fission.Internal.UTF8.html#stripQuotes"><span class="hs-identifier hs-var hs-var">stripQuotes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
</span><a href="Fission.Internal.UTF8.html#stripOptionalPrefix"><span class="hs-identifier hs-var">stripOptionalPrefix</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;\&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; (Text -&gt; Text) -&gt; Text -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
</span><a href="Fission.Internal.UTF8.html#stripOptionalSuffix"><span class="hs-identifier hs-var">stripOptionalSuffix</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;\&quot;&quot;</span></span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span class="annot"><a href="Fission.Internal.UTF8.html#stripQuotesBS"><span class="hs-identifier hs-type">stripQuotesBS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-106"></span><span id="stripQuotesBS"><span class="annot"><span class="annottext">stripQuotesBS :: ByteString -&gt; ByteString
</span><a href="Fission.Internal.UTF8.html#stripQuotesBS"><span class="hs-identifier hs-var hs-var">stripQuotesBS</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
</span><a href="Fission.Internal.UTF8.html#stripOptionalPrefixBS"><span class="hs-identifier hs-var">stripOptionalPrefixBS</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;\&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString)
-&gt; (ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
</span><a href="Fission.Internal.UTF8.html#stripOptionalSuffixBS"><span class="hs-identifier hs-var">stripOptionalSuffixBS</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;\&quot;&quot;</span></span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span class="annot"><a href="Fission.Internal.UTF8.html#stripQuotesLazyBS"><span class="hs-identifier hs-type">stripQuotesLazyBS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lazy.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lazy.ByteString</span></span><span>
</span><span id="line-109"></span><span id="stripQuotesLazyBS"><span class="annot"><span class="annottext">stripQuotesLazyBS :: ByteString -&gt; ByteString
</span><a href="Fission.Internal.UTF8.html#stripQuotesLazyBS"><span class="hs-identifier hs-var hs-var">stripQuotesLazyBS</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
</span><a href="Fission.Internal.UTF8.html#stripOptionalPrefixLazyBS"><span class="hs-identifier hs-var">stripOptionalPrefixLazyBS</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;\&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString)
-&gt; (ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
</span><a href="Fission.Internal.UTF8.html#stripOptionalSuffixLazyBS"><span class="hs-identifier hs-var">stripOptionalSuffixLazyBS</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;\&quot;&quot;</span></span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span class="hs-comment">{-| Strip one newline character from the end of a lazy `ByteString`.

    &gt;&gt;&gt; stripNewline &quot;;)\n&quot;
    &quot;;)&quot;

    &gt;&gt;&gt; stripNewline &quot;&lt;&gt;\n\n&quot;
    &quot;&lt;&gt;\n&quot;

    prop&gt; stripNewline (Lazy.append bs &quot;\n&quot;) == bs
    prop&gt; stripNewline (Lazy.append bs &quot;\n\n&quot;) == bs &lt;&gt; &quot;\n&quot;

-}</span><span>
</span><span id="line-123"></span><span class="annot"><a href="Fission.Internal.UTF8.html#stripNewline"><span class="hs-identifier hs-type">stripNewline</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lazy.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lazy.ByteString</span></span><span>
</span><span id="line-124"></span><span id="stripNewline"><span class="annot"><span class="annottext">stripNewline :: ByteString -&gt; ByteString
</span><a href="Fission.Internal.UTF8.html#stripNewline"><span class="hs-identifier hs-var hs-var">stripNewline</span></a></span></span><span> </span><span id="local-6989586621680186864"><span class="annot"><span class="annottext">bs :: ByteString
</span><a href="#local-6989586621680186864"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-125"></span><span>  </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621680186864"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-126"></span><span>    </span><span class="annot"><span class="annottext">ByteString -&gt; (ByteString -&gt; Maybe ByteString) -&gt; Maybe ByteString
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">|&gt;</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Maybe ByteString
</span><span class="hs-identifier hs-var">Lazy.stripSuffix</span></span><span> </span><span class="annot"><span class="hs-string">&quot;\n&quot;</span></span><span>
</span><span id="line-127"></span><span>    </span><span class="annot"><span class="annottext">Maybe ByteString -&gt; (Maybe ByteString -&gt; ByteString) -&gt; ByteString
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">|&gt;</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ByteString -&gt; ByteString
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621680186864"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span class="hs-comment">{-| Show text.

    &gt;&gt;&gt; textShow 1
    &quot;1&quot;

-}</span><span>
</span><span id="line-135"></span><span id="local-6989586621680186861"><span class="annot"><a href="Fission.Internal.UTF8.html#textShow"><span class="hs-identifier hs-type">textShow</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680186861"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680186861"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span></span><span>
</span><span id="line-136"></span><span id="textShow"><span class="annot"><span class="annottext">textShow :: a -&gt; Text
</span><a href="Fission.Internal.UTF8.html#textShow"><span class="hs-identifier hs-var hs-var">textShow</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Utf8Builder -&gt; Text
forall a. Display a =&gt; a -&gt; Text
</span><span class="hs-identifier hs-var">textDisplay</span></span><span> </span><span class="annot"><span class="annottext">(Utf8Builder -&gt; Text) -&gt; (a -&gt; Utf8Builder) -&gt; a -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Utf8Builder
forall a. Show a =&gt; a -&gt; Utf8Builder
</span><span class="hs-identifier hs-var">displayShow</span></span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span class="hs-comment">{-| Remove a number of characters from the beginning and the end of a lazy `ByteString`.

    &gt;&gt;&gt; stripNBS 3 &quot;aaabccc&quot;
    &quot;b&quot;

    &gt;&gt;&gt; stripNBS 0 &quot;b&quot;
    &quot;b&quot;

-}</span><span>
</span><span id="line-147"></span><span class="annot"><a href="Fission.Internal.UTF8.html#stripNBS"><span class="hs-identifier hs-type">stripNBS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lazy.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lazy.ByteString</span></span><span>
</span><span id="line-148"></span><span id="stripNBS"><span class="annot"><span class="annottext">stripNBS :: Natural -&gt; ByteString -&gt; ByteString
</span><a href="Fission.Internal.UTF8.html#stripNBS"><span class="hs-identifier hs-var hs-var">stripNBS</span></a></span></span><span> </span><span id="local-6989586621680186859"><span class="annot"><span class="annottext">n :: Natural
</span><a href="#local-6989586621680186859"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621680186858"><span class="annot"><span class="annottext">bs :: ByteString
</span><a href="#local-6989586621680186858"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-149"></span><span>  </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621680186858"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-150"></span><span>    </span><span class="annot"><span class="annottext">ByteString -&gt; (ByteString -&gt; ByteString) -&gt; ByteString
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">Lazy.take</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Int64
</span><span class="hs-identifier hs-var">Lazy.length</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621680186858"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Int64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621680186855"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span>    </span><span class="annot"><span class="annottext">ByteString -&gt; (ByteString -&gt; ByteString) -&gt; ByteString
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">Lazy.drop</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621680186855"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-152"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-153"></span><span>    </span><span class="annot"><a href="#local-6989586621680186855"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span>
</span><span id="line-154"></span><span>    </span><span id="local-6989586621680186855"><span class="annot"><span class="annottext">i :: Int64
</span><a href="#local-6989586621680186855"><span class="hs-identifier hs-var hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Int64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621680186859"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span class="hs-comment">{-| Remove a number of characters from the beginning and the end of some text.

    &gt;&gt;&gt; stripN 3 &quot;aaabccc&quot;
    &quot;b&quot;

    &gt;&gt;&gt; stripN 0 &quot;b&quot;
    &quot;b&quot;

    prop&gt; stripN n (Text.center (3 + fromIntegral n * 2) '_' &quot;o.O&quot;) == &quot;o.O&quot;

-}</span><span>
</span><span id="line-167"></span><span class="annot"><a href="Fission.Internal.UTF8.html#stripN"><span class="hs-identifier hs-type">stripN</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-168"></span><span id="stripN"><span class="annot"><span class="annottext">stripN :: Natural -&gt; Text -&gt; Text
</span><a href="Fission.Internal.UTF8.html#stripN"><span class="hs-identifier hs-var hs-var">stripN</span></a></span></span><span> </span><span id="local-6989586621680186853"><span class="annot"><span class="annottext">n :: Natural
</span><a href="#local-6989586621680186853"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">Text.dropEnd</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680186851"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; (Text -&gt; Text) -&gt; Text -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">Text.drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680186851"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-170"></span><span>    </span><span class="annot"><a href="#local-6989586621680186851"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-171"></span><span>    </span><span id="local-6989586621680186851"><span class="annot"><span class="annottext">i :: Int
</span><a href="#local-6989586621680186851"><span class="hs-identifier hs-var hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621680186853"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="hs-comment">-- | Helper for printing 'Text' to a console</span><span>
</span><span id="line-174"></span><span id="local-6989586621680186927"><span class="annot"><a href="Fission.Internal.UTF8.html#putText"><span class="hs-identifier hs-type">putText</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621680186927"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680186927"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-175"></span><span id="putText"><span class="annot"><span class="annottext">putText :: Text -&gt; m ()
</span><a href="Fission.Internal.UTF8.html#putText"><span class="hs-identifier hs-var hs-var">putText</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; m ()
forall (m :: * -&gt; *). MonadIO m =&gt; ByteString -&gt; m ()
</span><span class="hs-identifier hs-var">Strict.putStr</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; m ()) -&gt; (Text -&gt; ByteString) -&gt; Text -&gt; m ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><span class="hs-identifier hs-var">encodeUtf8</span></span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span class="hs-comment">-- | Helper for printing 'Text' to a console with a newline at the end</span><span>
</span><span id="line-178"></span><span id="local-6989586621680186848"><span class="annot"><a href="Fission.Internal.UTF8.html#putTextLn"><span class="hs-identifier hs-type">putTextLn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621680186848"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680186848"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-179"></span><span id="putTextLn"><span class="annot"><span class="annottext">putTextLn :: Text -&gt; m ()
</span><a href="Fission.Internal.UTF8.html#putTextLn"><span class="hs-identifier hs-var hs-var">putTextLn</span></a></span></span><span> </span><span id="local-6989586621680186847"><span class="annot"><span class="annottext">txt :: Text
</span><a href="#local-6989586621680186847"><span class="hs-identifier hs-var">txt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; m ()
forall (m :: * -&gt; *). MonadIO m =&gt; Text -&gt; m ()
</span><a href="Fission.Internal.UTF8.html#putText"><span class="hs-identifier hs-var">putText</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; m ()) -&gt; Text -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">&lt;|</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680186847"><span class="hs-identifier hs-var">txt</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;\n&quot;</span></span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span class="hs-comment">{-| Wrap text with some other piece of text.

    prop&gt; Text.head (wrapIn &quot;|&quot; s) == '|'
    prop&gt; Text.last (wrapIn &quot;|&quot; s) == '|'
    prop&gt; Text.length (wrapIn &quot;|&quot; s) == (Text.length s) + 2

-}</span><span>
</span><span id="line-188"></span><span class="annot"><a href="Fission.Internal.UTF8.html#wrapIn"><span class="hs-identifier hs-type">wrapIn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-189"></span><span id="wrapIn"><span class="annot"><span class="annottext">wrapIn :: Text -&gt; Text -&gt; Text
</span><a href="Fission.Internal.UTF8.html#wrapIn"><span class="hs-identifier hs-var hs-var">wrapIn</span></a></span></span><span> </span><span id="local-6989586621680186845"><span class="annot"><span class="annottext">wrapper :: Text
</span><a href="#local-6989586621680186845"><span class="hs-identifier hs-var">wrapper</span></a></span></span><span> </span><span id="local-6989586621680186844"><span class="annot"><span class="annottext">txt :: Text
</span><a href="#local-6989586621680186844"><span class="hs-identifier hs-var">txt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680186845"><span class="hs-identifier hs-var">wrapper</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680186844"><span class="hs-identifier hs-var">txt</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680186845"><span class="hs-identifier hs-var">wrapper</span></a></span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span class="annot"><a href="Fission.Internal.UTF8.html#wrapInBS"><span class="hs-identifier hs-type">wrapInBS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span>
</span><span id="line-192"></span><span id="wrapInBS"><span class="annot"><span class="annottext">wrapInBS :: ByteString -&gt; ByteString -&gt; ByteString
</span><a href="Fission.Internal.UTF8.html#wrapInBS"><span class="hs-identifier hs-var hs-var">wrapInBS</span></a></span></span><span> </span><span id="local-6989586621680186843"><span class="annot"><span class="annottext">wrapper :: ByteString
</span><a href="#local-6989586621680186843"><span class="hs-identifier hs-var">wrapper</span></a></span></span><span> </span><span id="local-6989586621680186842"><span class="annot"><span class="annottext">bs :: ByteString
</span><a href="#local-6989586621680186842"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621680186843"><span class="hs-identifier hs-var">wrapper</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621680186842"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621680186843"><span class="hs-identifier hs-var">wrapper</span></a></span><span>
</span><span id="line-193"></span></pre></body></html>